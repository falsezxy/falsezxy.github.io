<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>阿里云-设备管理平台部署 | Felix的个人博客</title><meta name="author" content="Felix"><meta name="copyright" content="Felix"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="阿里云-设备管理平台部署前言本文档详细记录了基于阿里云的设备管理平台从零到一的完整部署过程，涵盖网络基础设施配置、中间件部署、计算资源管理以及高可用架构设计等核心内容。通过本文档，读者可以深入了解从传统IT架构到云计算架构的转变，以及各个云服务组件之间如何协同工作。 云平台技术映射与架构设计一、网络基础设施层1. VPC（Virtual Private Cloud - 虚拟私有云）传统IT概念对应">
<meta property="og:type" content="article">
<meta property="og:title" content="阿里云-设备管理平台部署">
<meta property="og:url" content="http://example.com/2025/12/12/%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/index.html">
<meta property="og:site_name" content="Felix的个人博客">
<meta property="og:description" content="阿里云-设备管理平台部署前言本文档详细记录了基于阿里云的设备管理平台从零到一的完整部署过程，涵盖网络基础设施配置、中间件部署、计算资源管理以及高可用架构设计等核心内容。通过本文档，读者可以深入了解从传统IT架构到云计算架构的转变，以及各个云服务组件之间如何协同工作。 云平台技术映射与架构设计一、网络基础设施层1. VPC（Virtual Private Cloud - 虚拟私有云）传统IT概念对应">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/imgs/adater.jpg">
<meta property="article:published_time" content="2025-12-12T00:54:40.000Z">
<meta property="article:modified_time" content="2025-12-15T04:17:33.579Z">
<meta property="article:author" content="Felix">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/imgs/adater.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "阿里云-设备管理平台部署",
  "url": "http://example.com/2025/12/12/%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/",
  "image": "http://example.com/imgs/adater.jpg",
  "datePublished": "2025-12-12T00:54:40.000Z",
  "dateModified": "2025-12-15T04:17:33.579Z",
  "author": [
    {
      "@type": "Person",
      "name": "Felix",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/12/12/%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '阿里云-设备管理平台部署',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.0.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/imgs/background_header.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Felix的个人博客</span></a><a class="nav-page-title" href="/"><span class="site-name">阿里云-设备管理平台部署</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">阿里云-设备管理平台部署</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-12T00:54:40.000Z" title="Created 2025-12-12 08:54:40">2025-12-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-15T04:17:33.579Z" title="Updated 2025-12-15 12:17:33">2025-12-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="阿里云-设备管理平台部署"><a href="#阿里云-设备管理平台部署" class="headerlink" title="阿里云-设备管理平台部署"></a>阿里云-设备管理平台部署</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文档详细记录了基于阿里云的设备管理平台从零到一的完整部署过程，涵盖网络基础设施配置、中间件部署、计算资源管理以及高可用架构设计等核心内容。通过本文档，读者可以深入了解从传统IT架构到云计算架构的转变，以及各个云服务组件之间如何协同工作。</p>
<h2 id="云平台技术映射与架构设计"><a href="#云平台技术映射与架构设计" class="headerlink" title="云平台技术映射与架构设计"></a>云平台技术映射与架构设计</h2><h3 id="一、网络基础设施层"><a href="#一、网络基础设施层" class="headerlink" title="一、网络基础设施层"></a>一、网络基础设施层</h3><h4 id="1-VPC（Virtual-Private-Cloud-虚拟私有云）"><a href="#1-VPC（Virtual-Private-Cloud-虚拟私有云）" class="headerlink" title="1. VPC（Virtual Private Cloud - 虚拟私有云）"></a>1. VPC（Virtual Private Cloud - 虚拟私有云）</h4><p><strong>传统IT概念对应</strong>：在企业数据中心中，我们会通过物理网络设备（交换机、路由器）隔离不同部门或项目的网络。</p>
<p><strong>云平台作用</strong>：VPC是阿里云上完全隔离的虚拟网络环境。你可以在VPC中自定义IP地址范围、创建子网、配置路由规则。在本项目中，我们创建了”设备管理平台-VPC”，为所有云资源提供了一个专属的网络空间，确保不同项目之间的网络完全隔离。</p>
<p><strong>实际应用</strong>：我们选择杭州地域创建VPC，使用172.16.0.0&#x2F;16作为CIDR地址块，为所有计算、存储、数据库资源提供网络基础。</p>
<h4 id="2-交换机（Subnet-Vswitch）"><a href="#2-交换机（Subnet-Vswitch）" class="headerlink" title="2. 交换机（Subnet&#x2F;Vswitch）"></a>2. 交换机（Subnet&#x2F;Vswitch）</h4><p><strong>传统IT概念对应</strong>：物理网络中的二层交换机，用于划分局域网，让不同的设备通过子网进行通信。</p>
<p><strong>云平台作用</strong>：交换机是VPC内的子网划分工具。一个VPC可以创建多个交换机，每个交换机对应不同的可用区（可用区是独立的物理数据中心），实现跨可用区高可用部署。</p>
<p><strong>实际应用</strong>：在本项目中，我们根据不同的部署时间创建了两个交换机：一个在杭州可用区B（172.16.0.0&#x2F;24）用于初期测试，一个在杭州可用区K（172.16.2.0&#x2F;24）用于后续的RDS和正式环境。虽然这在实际部署中造成了网络分离，但在同一VPC内的资源应该通过配置路由规则实现互通。</p>
<h4 id="3-安全组（Security-Group）"><a href="#3-安全组（Security-Group）" class="headerlink" title="3. 安全组（Security Group）"></a>3. 安全组（Security Group）</h4><p><strong>传统IT概念对应</strong>：企业防火墙或者硬件防护设备的访问控制列表（ACL）。</p>
<p><strong>云平台作用</strong>：安全组是实例级别的虚拟防火墙，通过入站（Inbound）和出站（Outbound）规则控制流量。每个ECS实例都必须绑定至少一个安全组，安全组决定了实例能接收什么流量，能发送什么流量。</p>
<p><strong>实际应用</strong>：我们创建了”ECS安全组”，配置规则包括：允许来自Nginx的80、443端口HTTP&#x2F;HTTPS流量，允许Java服务的8090端口流量，允许SSH的22端口用于远程管理。这样既保证了服务的可访问性，又防止了非法访问。</p>
<h4 id="4-EIP（弹性公网IP）"><a href="#4-EIP（弹性公网IP）" class="headerlink" title="4. EIP（弹性公网IP）"></a>4. EIP（弹性公网IP）</h4><p><strong>传统IT概念对应</strong>：数据中心中用于对外发布服务的公网IP地址。</p>
<p><strong>云平台作用</strong>：EIP是一个独立购买和管理的公网IP资源，可以动态绑定到任何需要公网访问的实例。相比固定的公网IP，EIP更灵活——当实例故障时，可以快速解绑EIP并绑定到新实例，实现快速切换。</p>
<p><strong>实际应用</strong>：我们为跳板机绑定了EIP，作为进入内网进行管理的唯一入口。这样既确保了内网其他ECS的安全（它们没有公网IP，无法直接从互联网访问），又提供了灵活的远程管理能力。</p>
<h3 id="二、计算与部署层"><a href="#二、计算与部署层" class="headerlink" title="二、计算与部署层"></a>二、计算与部署层</h3><h4 id="1-ECS（Elastic-Compute-Service-弹性云服务器）"><a href="#1-ECS（Elastic-Compute-Service-弹性云服务器）" class="headerlink" title="1. ECS（Elastic Compute Service - 弹性云服务器）"></a>1. ECS（Elastic Compute Service - 弹性云服务器）</h4><p><strong>传统IT概念对应</strong>：物理服务器。在数据中心中，我们采购不同配置的服务器运行不同的业务。</p>
<p><strong>云平台作用</strong>：ECS是阿里云的虚拟机服务，可以按需购买不同规格的实例。每个ECS实例可以独立配置操作系统、内存、CPU、存储。相比物理服务器，ECS有以下优势：弹性伸缩（快速增减实例）、按量计费（用多少付多少）、免去硬件维护成本。</p>
<p><strong>实际应用</strong>：在本项目中，我们部署了4台ECS：</p>
<ul>
<li>2台Nginx服务器（1核2GB CentOS 7.9）：部署反向代理，转发静态资源和后端请求</li>
<li>2台Java服务器（1核2GB CentOS 7.9）：部署Java微服务，提供业务逻辑处理</li>
<li>1台跳板机（复用Nginx-1）：绑定EIP，用于本地SSH远程管理内网的其他ECS</li>
</ul>
<p>每台ECS都挂载了40GB的云盘作为系统盘，确保有足够的存储空间。</p>
<h4 id="2-镜像（Image）"><a href="#2-镜像（Image）" class="headerlink" title="2. 镜像（Image）"></a>2. 镜像（Image）</h4><p><strong>传统IT概念对应</strong>：服务器的操作系统镜像文件。</p>
<p><strong>云平台作用</strong>：镜像是ECS实例的启动模板。阿里云提供公共镜像（如CentOS、Ubuntu等官方操作系统），也支持自定义镜像（基于某个ECS快照制作，保存软件环境配置）。使用自定义镜像可以快速创建具有相同环境的多个ECS。</p>
<p><strong>实际应用</strong>：我们选择了CentOS 7.9作为所有ECS的操作系统镜像，这与传统IT环境保持一致，便于与现有的运维流程对接。</p>
<h3 id="三、网络与负载均衡层"><a href="#三、网络与负载均衡层" class="headerlink" title="三、网络与负载均衡层"></a>三、网络与负载均衡层</h3><h4 id="1-SLB-ALB（负载均衡）"><a href="#1-SLB-ALB（负载均衡）" class="headerlink" title="1. SLB&#x2F;ALB（负载均衡）"></a>1. SLB&#x2F;ALB（负载均衡）</h4><p><strong>传统IT概念对应</strong>：数据中心中的硬件负载均衡器，如F5、Citrix等。</p>
<p><strong>云平台作用</strong>：负载均衡（SLB是第四层负载均衡，ALB是第七层应用负载均衡）将来自客户端的流量分散到后端多个服务器，实现高可用和水平扩展。其核心功能包括：</p>
<ul>
<li><strong>流量分发</strong>：根据配置的算法（轮询、加权轮询、IP哈希等）将请求转发到不同的后端服务器</li>
<li><strong>健康检查</strong>：定期检测后端服务器的健康状态，自动剔除故障节点，流量自动转向正常节点</li>
<li><strong>会话保持</strong>：同一用户的多个请求可以路由到同一台后端服务器</li>
<li><strong>HTTPS卸载</strong>：负载均衡可以终止HTTPS连接，减轻后端服务器的CPU压力</li>
</ul>
<p><strong>实际应用</strong>：我们创建了一个ALB实例，作为整个平台的统一访问入口。用户的所有请求（无论是静态资源还是Java API调用）都通过SLB，由SLB转发到2台Nginx服务器。当其中一台Nginx故障时，SLB自动将流量转向另一台，用户无感知，从而实现高可用。</p>
<h4 id="2-ACR（阿里云容器镜像仓库）"><a href="#2-ACR（阿里云容器镜像仓库）" class="headerlink" title="2. ACR（阿里云容器镜像仓库）"></a>2. ACR（阿里云容器镜像仓库）</h4><p><strong>传统IT概念对应</strong>：内部的应用制品库。</p>
<p><strong>云平台作用</strong>：在使用Docker和Kubernetes的微服务架构中，ACR用于存储和管理容器镜像（相当于软件的打包格式）。支持私有仓库和公开仓库，集成了镜像安全扫描、镜像签名等高级特性。</p>
<p><strong>说明</strong>：虽然本项目中未涉及容器化部署，但在更高级的云原生架构中，ACR是必需的组件。</p>
<h3 id="四、存储层"><a href="#四、存储层" class="headerlink" title="四、存储层"></a>四、存储层</h3><h4 id="1-NAS（Network-Attached-Storage-网络存储）"><a href="#1-NAS（Network-Attached-Storage-网络存储）" class="headerlink" title="1. NAS（Network Attached Storage - 网络存储）"></a>1. NAS（Network Attached Storage - 网络存储）</h4><p><strong>传统IT概念对应</strong>：企业的文件服务器或NAS设备。</p>
<p><strong>云平台作用</strong>：NAS是阿里云的托管网络存储服务。通过NFS或SMB协议，多个ECS实例可以挂载同一个NAS文件系统，实现共享存储。相比ECS本地盘，NAS有以下优势：</p>
<ul>
<li><strong>共享访问</strong>：多个ECS可以同时访问同一份文件，避免数据重复</li>
<li><strong>数据持久化</strong>：存储在NAS上的数据不会因为ECS重启或删除而丢失</li>
<li><strong>弹性扩容</strong>：无需关心容量上限，自动扩展</li>
<li><strong>高可用</strong>：阿里云在后端冗余存储，保证数据安全</li>
</ul>
<p><strong>实际应用</strong>：我们创建了一个NAS，通过NFS协议：</p>
<ul>
<li>2台Nginx ECS挂载NAS上的&#x2F;html目录，用于存储前端静态资源（dist包）</li>
<li>2台Java ECS挂载NAS上的&#x2F;java目录，用于存储Java应用的JAR包</li>
</ul>
<p>这样做的好处是：当需要更新应用时，只需上传一份文件到NAS，所有服务器都能立即使用最新版本，无需逐个登录每台服务器上传和更新。</p>
<h4 id="2-RDS（关系型数据库服务）"><a href="#2-RDS（关系型数据库服务）" class="headerlink" title="2. RDS（关系型数据库服务）"></a>2. RDS（关系型数据库服务）</h4><p><strong>传统IT概念对应</strong>：企业自建的MySQL、PostgreSQL等数据库服务器。</p>
<p><strong>云平台作用</strong>：RDS是阿里云的托管数据库服务。与自建数据库相比，RDS的优势包括：</p>
<ul>
<li><strong>自动备份与恢复</strong>：支持自动备份、时间点恢复（PITR）、跨地域备份</li>
<li><strong>高可用</strong>：支持主从同步复制，主库故障时自动切换到从库，实现RPO&#x3D;0、RTO&lt;30秒的高可用</li>
<li><strong>性能优化</strong>：云端自动优化数据库参数，提供性能分析报告</li>
<li><strong>安全加固</strong>：支持数据加密、SQL防注入审计、访问控制等</li>
<li><strong>免运维</strong>：数据库补丁、升级、监控等全部由阿里云处理</li>
</ul>
<p><strong>实际应用</strong>：我们购买了一个RDS MySQL实例，用于存储设备管理平台的所有业务数据。通过创建高权限账号和导入数据库(yl_app)，完成数据迁移。在DMS（数据管理服务）的辅助下，我们验证了数据导入的成功。</p>
<h4 id="3-Tair（兼容Redis）"><a href="#3-Tair（兼容Redis）" class="headerlink" title="3. Tair（兼容Redis）"></a>3. Tair（兼容Redis）</h4><p><strong>传统IT概念对应</strong>：缓存服务器。在传统架构中，我们可能使用Memcached或Redis来缓存热点数据。</p>
<p><strong>云平台作用</strong>：Tair是阿里云基于Redis协议开发的高性能缓存服务。作为业务数据库的补充，Tair的作用包括：</p>
<ul>
<li><strong>加速查询</strong>：对热点数据进行缓存，减少数据库查询，提升应用性能</li>
<li><strong>会话存储</strong>：存储用户会话数据，支持分布式会话共享</li>
<li><strong>计数器与排行榜</strong>：利用Redis的原子操作实现高并发的计数场景</li>
<li><strong>消息队列</strong>：利用Redis的List数据结构实现简单的消息队列</li>
</ul>
<p><strong>实际应用</strong>：我们启用了Tair的免密访问功能。同一VPC下的ECS无需提供密码即可连接，简化了配置。通过白名单设置进一步加强了安全控制，确保只有授权的ECS才能访问Tair。</p>
<h3 id="五、数据迁移与管理层"><a href="#五、数据迁移与管理层" class="headerlink" title="五、数据迁移与管理层"></a>五、数据迁移与管理层</h3><h4 id="1-DTS（数据传输服务）"><a href="#1-DTS（数据传输服务）" class="headerlink" title="1. DTS（数据传输服务）"></a>1. DTS（数据传输服务）</h4><p><strong>传统IT概念对应</strong>：数据库迁移工具或脚本。</p>
<p><strong>云平台作用</strong>：DTS提供数据库、缓存、消息队列等多种数据源的迁移和同步能力。支持从自建数据库、其他云厂商的数据库迁移到阿里云RDS，以及RDS之间的迁移。DTS提供：</p>
<ul>
<li><strong>全量迁移</strong>：一次性迁移历史数据</li>
<li><strong>增量迁移</strong>：实时同步迁移过程中产生的新数据（零停机迁移）</li>
<li><strong>双向同步</strong>：支持多个数据源之间的实时数据同步</li>
</ul>
<p><strong>实际应用</strong>：在本项目中，我们通过DMS（数据管理服务）的SQL导入功能，将本地的yl_app.sql文件导入到RDS的yl_app数据库中。虽然这是一个简单的全量迁移，但DTS&#x2F;DMS为更复杂的迁移场景（如从传统MySQL迁移到云RDS）提供了完整的工具和流程。</p>
<h4 id="2-DMS（数据管理服务）"><a href="#2-DMS（数据管理服务）" class="headerlink" title="2. DMS（数据管理服务）"></a>2. DMS（数据管理服务）</h4><p><strong>云平台作用</strong>：DMS是一个数据库运维平台，提供SQL编辑、执行、任务调度、数据导入导出等功能。它可以与多个数据源（MySQL、PostgreSQL、Oracle等）集成，统一管理所有数据库。在本项目中，我们使用DMS的导入功能将本地SQL脚本导入到RDS。</p>
<h3 id="六、日志与监控层"><a href="#六、日志与监控层" class="headerlink" title="六、日志与监控层"></a>六、日志与监控层</h3><h4 id="1-SLS（日志服务）"><a href="#1-SLS（日志服务）" class="headerlink" title="1. SLS（日志服务）"></a>1. SLS（日志服务）</h4><p><strong>传统IT概念对应</strong>：企业的日志收集和分析系统，如ELK Stack（Elasticsearch, Logstash, Kibana）。</p>
<p><strong>云平台作用</strong>：SLS是阿里云的日志收集、存储、查询、分析一体化平台。其核心能力包括：</p>
<ul>
<li><strong>日志收集</strong>：通过Logstash Agent或API从各个ECS、应用、中间件收集日志</li>
<li><strong>实时查询</strong>：秒级别查询海量日志，支持复杂的查询语法</li>
<li><strong>统计分析</strong>：自动统计日志中的关键信息，生成报告和图表</li>
<li><strong>告警</strong>：基于日志内容设置告警规则，异常时自动通知</li>
</ul>
<p><strong>实际应用</strong>：在本项目的Java微服务中，我们可以配置Java应用的日志输出到SLS，实现集中日志管理。通过查看SLS中的日志，运维人员可以快速定位应用故障。</p>
<h3 id="简要对应关系"><a href="#简要对应关系" class="headerlink" title="简要对应关系"></a>简要对应关系</h3><p>物理服务器 &#x2F; 虚拟机 → <strong>ECS</strong></p>
<p>虚拟私网 &#x2F; 网络隔离 → <strong>VPC</strong></p>
<p>子网 &#x2F; 网络分段 → <strong>交换机（VSwitch）</strong></p>
<p>防火墙 &#x2F; 网络访问控制 → <strong>安全组（Security Group）</strong></p>
<p>公网IP地址 → <strong>弹性公网IP（EIP）</strong></p>
<p>硬件负载均衡器 → <strong>负载均衡（SLB&#x2F;ALB）</strong></p>
<p>NAS存储 &#x2F; 文件服务器 → <strong>NAS</strong></p>
<p>云盘 &#x2F; 块存储 → <strong>云盘</strong></p>
<p>自建MySQL数据库 → <strong>关系型数据库（RDS）</strong></p>
<p>自建Redis &#x2F; Memcached → <strong>键值对数据库（Tair）</strong></p>
<p>数据库迁移工具 → <strong>数据传输服务（DTS）</strong></p>
<p>数据库运维管理 → <strong>数据库管理（DMS）</strong></p>
<p>日志收集与分析系统 → <strong>日志服务（SLS）</strong></p>
<p>应用性能监控 → <strong>应用实时监控（ARMS）</strong></p>
<p>告警与通知 → <strong>云监控</strong></p>
<p>容器镜像仓库 → <strong>容器镜像服务（ACR）</strong></p>
<p>Kubernetes编排 → <strong>容器服务Kubernetes版（ACK）</strong></p>
<p>配置管理 → <strong>应用配置管理（ACM）</strong></p>
<p>API网关 → <strong>API网关</strong></p>
<p>域名管理 → <strong>云解析</strong></p>
<p>SSL证书 → <strong>SSL证书服务</strong></p>
<p>访问控制 → <strong>RAM（资源访问管理）</strong></p>
<p>密钥管理 → <strong>密钥管理服务（KMS）</strong></p>
<p>备份与恢复 → <strong>云备份</strong></p>
<hr>
<h2 id="部署过程"><a href="#部署过程" class="headerlink" title="部署过程"></a>部署过程</h2><h3 id="前置网络配置（VPC-安全组）"><a href="#前置网络配置（VPC-安全组）" class="headerlink" title="前置网络配置（VPC+安全组）"></a>前置网络配置（VPC+安全组）</h3><h4 id="VPC与交换机购买与配置"><a href="#VPC与交换机购买与配置" class="headerlink" title="VPC与交换机购买与配置"></a>VPC与交换机购买与配置</h4><p>首先需要创建虚拟私有云（VPC），作为所有云资源的网络容器。登录阿里云控制台，进入VPC管理页面，点击”创建VPC”。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>选择地域：根据业务地理位置选择最近的地域，我们选择了杭州，以降低网络延迟</li>
<li>设置VPC CIDR块：输入172.16.0.0&#x2F;16，为VPC分配IP地址范围</li>
<li>创建交换机：在VPC中创建一个或多个交换机，每个交换机需指定：<ul>
<li>所属可用区：可用区是阿里云数据中心内的独立机房，选择可用区K（或其他可用区）</li>
<li>交换机CIDR块：输入172.16.2.0&#x2F;24，作为VPC内的子网</li>
</ul>
</li>
<li>完成创建：系统会生成基本的路由表，实现VPC内的网络通信</li>
</ul>
<p>创建完成后，记录VPC ID和交换机ID，后续创建ECS时需要指定这些参数。</p>
<p><img src="/./imgs/image-20251210220925880.png" alt="image-20251210220925880"></p>
<p>交换机</p>
<p><img src="/./imgs/image-20251210220933534.png" alt="image-20251210220933534"></p>
<p>VPC创建后的基本信息</p>
<p><img src="/./imgs/image-20251210221231520.png" alt="image-20251210221231520"></p>
<h4 id="安全组创建"><a href="#安全组创建" class="headerlink" title="安全组创建"></a>安全组创建</h4><p>安全组用于控制进出流量。在VPC控制台中进入”安全组”页面，点击”创建安全组”。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>组名称：输入”ECS安全组”</li>
<li>网络类型：选择”VPC”</li>
<li>VPC：选择刚才创建的”设备管理平台-VPC”</li>
<li>完成创建后，进入安全组详情，配置入站规则：<ul>
<li>允许HTTP流量：协议选择TCP，端口80，授权对象为0.0.0.0&#x2F;0（允许任何来源）</li>
<li>允许HTTPS流量：协议选择TCP，端口443，授权对象为0.0.0.0&#x2F;0</li>
<li>允许Java服务流量：协议选择TCP，端口8090，授权对象为0.0.0.0&#x2F;0</li>
<li>允许SSH流量：协议选择TCP，端口22，授权对象为0.0.0.0&#x2F;0（实际应用中应限制为特定IP）</li>
</ul>
</li>
<li>出站规则默认允许所有流量，无需修改</li>
</ul>
<p><img src="/./imgs/image-20251210221532503.png" alt="image-20251210221532503"></p>
<p><img src="/./imgs/image-20251210221542653.png" alt="image-20251210221542653"></p>
<h3 id="EIP购买和配置"><a href="#EIP购买和配置" class="headerlink" title="EIP购买和配置"></a>EIP购买和配置</h3><p>EIP（弹性公网IP）是用于对外访问的公网IP地址。在VPC控制台进入”弹性公网IP”页面，点击”创建弹性公网IP”。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>地域：选择与VPC相同的地域（杭州）</li>
<li>带宽：选择按流量计费，初始设置5Mbps（可根据需要调整）</li>
<li>完成购买后，记录EIP地址，后续需要将其绑定到跳板机</li>
</ul>
<p><img src="/./imgs/image-20251210221753868.png" alt="image-20251210221753868"></p>
<p><img src="/./imgs/image-20251210221920129.png" alt="image-20251210221920129"></p>
<p><img src="/./imgs/image-20251210221931690.png" alt="image-20251210221931690"></p>
<h3 id="中间件部署配置（先中间件后ECS）"><a href="#中间件部署配置（先中间件后ECS）" class="headerlink" title="中间件部署配置（先中间件后ECS）"></a>中间件部署配置（先中间件后ECS）</h3><h4 id="RDS（MySQL）配置"><a href="#RDS（MySQL）配置" class="headerlink" title="RDS（MySQL）配置"></a>RDS（MySQL）配置</h4><h5 id="创建实例"><a href="#创建实例" class="headerlink" title="创建实例"></a>创建实例</h5><ul>
<li>引擎类型：选择MySQL</li>
<li>版本：选择MySQL 5.7或8.0（根据应用兼容性选择）</li>
<li>地域与可用区：选择与Nginx ECS相同的地域和可用区</li>
<li>VPC与交换机：选择”设备管理平台-VPC”和对应的交换机</li>
<li>实例规格：选择1核2GB（初期够用，可后续扩容）</li>
<li>点击”确认创建”</li>
</ul>
<p><img src="/./imgs/image-20251210222140661.png" alt="image-20251210222140661"></p>
<p><img src="/./imgs/image-20251210222224832.png" alt="image-20251210222224832"></p>
<p><img src="/./imgs/image-20251210222235393.png" alt="image-20251210222235393"></p>
<h5 id="创建高权限账号"><a href="#创建高权限账号" class="headerlink" title="创建高权限账号"></a>创建高权限账号</h5><ul>
<li>进入RDS实例详情页，点击”账号管理”</li>
<li>点击”创建账号”，输入账号名（如dbuser）和密码（如Dbuser@123）</li>
<li>选择”高权限账号”</li>
<li>点击”确认创建”</li>
</ul>
<p><img src="/./imgs/image-20251210222721028.png" alt="image-20251210222721028"></p>
<h5 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h5><ul>
<li>点击”数据库管理”</li>
<li>点击”创建数据库”，输入数据库名（yl_app）</li>
<li>选择字符集UTF-8MB4（支持中文和emoji）</li>
<li>点击”确认创建”</li>
</ul>
<p><img src="/./imgs/image-20251210223410675.png" alt="image-20251210223410675"></p>
<h4 id="DMS数据管理服务"><a href="#DMS数据管理服务" class="headerlink" title="DMS数据管理服务"></a>DMS数据管理服务</h4><ul>
<li>进入”数据库管理DMS”控制台</li>
<li>点击”新增实例”，选择MySQL，输入RDS的访问信息（主机、端口3306、用户名、密码）</li>
<li>选择”安全托管”模式（系统会验证你的身份）</li>
<li>连接成功后，点击”数据导入”</li>
<li>选择刚才创建的yl_app数据库，上传本地的yl_app.sql文件</li>
<li>系统会自动执行SQL脚本，导入所有表和数据</li>
</ul>
<h5 id="新增mysql实例"><a href="#新增mysql实例" class="headerlink" title="新增mysql实例"></a>新增mysql实例</h5><p>数据导入–》实例列表，新增实例选择mysql</p>
<p><img src="/./imgs/image-20251210224035257.png" alt="image-20251210224035257"></p>
<p>安全托管手动，输入创建的高权限账号密码，选择数据库</p>
<p><img src="/./imgs/image-20251210224831550.png" alt="image-20251210224831550"></p>
<p><img src="/./imgs/image-20251210224942155.png" alt="image-20251210224942155"></p>
<h5 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h5><p>数据导入—》选择数据导入，选中yl_app数据库，上传本地的yl_app.sql文件</p>
<p><img src="/./imgs/image-20251210225114126.png" alt="image-20251210225114126"></p>
<p><img src="/./imgs/image-20251210225432958.png" alt="image-20251210225432958"></p>
<h5 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h5><p>测试是否上传数据成功，进入查询控制台</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">use yl_app;</span><br><span class="line">show tables;</span><br></pre></td></tr></table></figure>

<p><img src="/./imgs/image-20251210230001825.png" alt="image-20251210230001825"></p>
<h4 id="Tair（兼容Redis）配置"><a href="#Tair（兼容Redis）配置" class="headerlink" title="Tair（兼容Redis）配置"></a>Tair（兼容Redis）配置</h4><h5 id="创建实例-1"><a href="#创建实例-1" class="headerlink" title="创建实例"></a>创建实例</h5><ul>
<li>产品类型：选择”Tair”</li>
<li>地域与可用区：选择与Nginx ECS相同的地域和可用区</li>
<li>VPC与交换机：选择”设备管理平台-VPC”和对应的交换机</li>
<li>实例规格：选择1GB（初期够用）</li>
</ul>
<p><img src="/./imgs/image-20251210230445524.png" alt="image-20251210230445524"></p>
<p><img src="/./imgs/image-20251210231747131.png" alt="image-20251210231747131"></p>
<h5 id="免密访问"><a href="#免密访问" class="headerlink" title="免密访问"></a>免密访问</h5><p>设置免密访问，同一VPC下的设备无需密码即可访问</p>
<p><img src="/./imgs/image-20251210232157892.png" alt="image-20251210232157892"></p>
<p>开启免密</p>
<p><img src="/./imgs/image-20251210232252868.png" alt="image-20251210232252868"></p>
<h5 id="设置白名单"><a href="#设置白名单" class="headerlink" title="设置白名单"></a>设置白名单</h5><p>添加2个内网IP网段（172.16.0.0&#x2F;24、172.16.2.0&#x2F;24）</p>
<p>这样即使启用了免密访问，也确保只有授权的ECS才能访问Tair</p>
<p><img src="/./imgs/image-20251210232345467.png" alt="image-20251210232345467"></p>
<h4 id="NAS配置（存储dist-jar包）"><a href="#NAS配置（存储dist-jar包）" class="headerlink" title="NAS配置（存储dist&#x2F;jar包）"></a>NAS配置（存储dist&#x2F;jar包）</h4><p>进入阿里云”文件存储NAS”控制台，点击”创建文件系统”。</p>
<ul>
<li>文件系统类型：选择”通用型NAS”</li>
<li>地域与可用区：选择与Nginx ECS一致的地域和可用区（如杭州K）</li>
<li>协议类型：选择”NFS”（Network File System，UNIX&#x2F;Linux标准的文件共享协议）</li>
<li>网络配置：<ul>
<li>VPC：选择”设备管理平台-VPC”</li>
<li>交换机：选择”应用交换机”</li>
</ul>
</li>
<li>点击”确认创建”</li>
</ul>
<p>等待NAS创建完成。创建后的NAS将作为共享存储，2台Nginx服务器和2台Java服务器都会挂载到这个NAS，以访问共享的文件。</p>
<p><img src="/./imgs/image-20251210232751329.png" alt="image-20251210232751329"></p>
<p><img src="/./imgs/image-20251210233217308.png" alt="image-20251210233217308"></p>
<p><strong>注意</strong>：上面准备中，由于我初始的交换机选择的杭州B（172.16.0.0），后续到RDS开始重新创建的在杭州K（172.16.2.0），理应同一VPC中应该可以通过内网直接通信</p>
<h3 id="ECS部署配置（按角色部署）"><a href="#ECS部署配置（按角色部署）" class="headerlink" title="ECS部署配置（按角色部署）"></a>ECS部署配置（按角色部署）</h3><table>
<thead>
<tr>
<th>ECS角色</th>
<th>数量</th>
<th>配置</th>
<th>镜像类型</th>
<th>备注</th>
<th>IP</th>
</tr>
</thead>
<tbody><tr>
<td>Nginx服务器</td>
<td>2台</td>
<td>1c2g</td>
<td>CentOS 7.9</td>
<td>编译安装Nginx，挂载NAS存储dist包</td>
<td>172.16.2.20、172.16.2.21</td>
</tr>
<tr>
<td>Java服务器</td>
<td>2台</td>
<td>1c2g</td>
<td>CentOS 7.9</td>
<td>部署Java微服务，挂载NAS存储jar包</td>
<td>172.16.2.22、172.16.2.23</td>
</tr>
<tr>
<td>跳板机</td>
<td>1台</td>
<td>1c2g</td>
<td>复用1台Nginx ECS</td>
<td>绑定EIP，用于本地Xshell管理其他内网ECS</td>
<td></td>
</tr>
</tbody></table>
<h4 id="购买esc"><a href="#购买esc" class="headerlink" title="购买esc"></a>购买esc</h4><ul>
<li>地域：选择杭州</li>
<li>可用区：选择与上述中间件相同的可用区（K）</li>
<li>镜像：选择”CentOS 7.9”</li>
<li>实例规格：选择”1核2GB”（ecs.t5.small）</li>
<li>网络配置：<ul>
<li>VPC：选择”设备管理平台-VPC”</li>
<li>交换机：选择”应用交换机”</li>
<li>公网IP：选择”不分配”（只有跳板机需要公网IP）</li>
</ul>
</li>
<li>安全组：选择刚才创建的”ECS安全组”</li>
<li>系统盘：选择”高效云盘”，容量40GB</li>
<li>登录方式：选择”密码”，输入密码Zxy12345</li>
<li>点击”确认创建”</li>
</ul>
<p><strong>购买数量</strong>：总共购买4台ECS（后续将分别部署Nginx和Java应用）</p>
<p><img src="/./imgs/image-20251211121929148.png" alt="image-20251211121929148"></p>
<p><img src="/./imgs/image-20251211121956472.png" alt="image-20251211121956472"></p>
<p><img src="/./imgs/image-20251211122008116.png" alt="image-20251211122008116"></p>
<p><img src="/./imgs/image-20251211122121184.png" alt="image-20251211122121184"></p>
<p><img src="/./imgs/image-20251211122455830.png" alt="image-20251211122455830"></p>
<p>密码Zxy12345</p>
<h4 id="配置跳板机（复用的nginx-1-ecs）"><a href="#配置跳板机（复用的nginx-1-ecs）" class="headerlink" title="配置跳板机（复用的nginx-1 ecs）"></a>配置跳板机（复用的nginx-1 ecs）</h4><p>跳板机是进入内网的唯一入口。我们复用其中一台Nginx ECS（Nginx-1）作为跳板机。</p>
<p><strong>绑定EIP</strong>：</p>
<ul>
<li>进入ECS控制台，找到Nginx-1实例</li>
<li>点击”更多” → “网络和安全” → “绑定弹性公网IP”</li>
<li>在弹出的页面中选择刚才购买的EIP</li>
<li>点击”确认绑定”</li>
</ul>
<p><img src="/./imgs/image-20251211123137859.png" alt="image-20251211123137859"></p>
<p><img src="/./imgs/image-20251211123212854.png" alt="image-20251211123212854"></p>
<p><strong>测试跳板机访问</strong>：</p>
<ul>
<li>本地打开Xshell（或其他SSH客户端）</li>
<li>新建会话，参数配置如下：<ul>
<li>主机：输入EIP地址（如47.99.xxx.xxx）</li>
<li>端口：22</li>
<li>用户名：root</li>
<li>密码：Zxy12345（ECS创建时设置的密码）</li>
</ul>
</li>
<li>点击”连接”，如能成功登录，说明跳板机配置正常</li>
</ul>
<p>xshell能正常连接</p>
<p><img src="/./imgs/image-20251211123432508.png" alt="image-20251211123432508"></p>
<p><img src="/./imgs/image-20251211123401492.png" alt="image-20251211123401492"></p>
<p>3.通过ssh 172.16.2.21能连接内网服务器成功</p>
<p><img src="/./imgs/image-20251211123547037.png" alt="image-20251211123547037"></p>
<p>内网通信正常；后续管理其他内网ECS均通过该跳板机操作。</p>
<h4 id="Nginx-ecs部署（编译安装）"><a href="#Nginx-ecs部署（编译安装）" class="headerlink" title="Nginx ecs部署（编译安装）"></a>Nginx ecs部署（编译安装）</h4><h5 id="安装依赖与编译Nginx（两台Nginx-ECS操作一致）"><a href="#安装依赖与编译Nginx（两台Nginx-ECS操作一致）" class="headerlink" title="安装依赖与编译Nginx（两台Nginx ECS操作一致）"></a>安装依赖与编译Nginx（两台Nginx ECS操作一致）</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装Nginx编译所需的依赖包，确保编译过程无缺失</span></span><br><span class="line">yum install -y gcc gcc-c++ make pcre pcre-devel zlib zlib-devel openssl openssl-devel lrzsz</span><br><span class="line"><span class="comment"># 上传Nginx 1.20.2源码包（与传统环境版本一致）</span></span><br><span class="line">wget https://nginx.org/download/nginx-1.20.2.tar.gz</span><br><span class="line"><span class="comment"># 解压源码包到/opt目录</span></span><br><span class="line">tar zxvf nginx-1.20.2.tar.gz -C /opt</span><br><span class="line"><span class="comment"># 进入解压后的目录，执行配置命令，指定安装路径、运行用户和启用模块</span></span><br><span class="line"><span class="built_in">cd</span> /opt/nginx-1.20.2</span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/nginx \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-http_ssl_module</span><br><span class="line"><span class="comment"># 编译并安装Nginx</span></span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"><span class="comment"># 创建Nginx运行用户（无登录权限，提升安全性）</span></span><br><span class="line">useradd -M -s /sbin/nologin nginx</span><br><span class="line"></span><br><span class="line"><span class="comment">#让系统识别nginx的操作命令</span></span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/nginx/sbin/nginx /usr/local/sbin/	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置Nginx为系统服务，确保开机自启</span></span><br><span class="line"><span class="built_in">cat</span> &gt; /lib/systemd/system/nginx.service &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=nginx</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string">PIDFile=/usr/local/nginx/logs/nginx.pid</span></span><br><span class="line"><span class="string">ExecStart=/usr/local/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">ExecReload=/bin/kill -s HUP $MAINPID</span></span><br><span class="line"><span class="string">ExecStop=/bin/kill -s QUIT $MAINPID</span></span><br><span class="line"><span class="string">PrivateTmp=true</span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment"># 设置服务文件权限</span></span><br><span class="line"><span class="built_in">chmod</span> 754 /lib/systemd/system/nginx.service</span><br><span class="line"><span class="comment"># 重新加载系统服务配置</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl start nginx.service</span><br><span class="line">systemctl <span class="built_in">enable</span> nginx.service</span><br></pre></td></tr></table></figure>

<p>编译安装</p>
<p><img src="/./imgs/image-20251211124548297.png" alt="image-20251211124548297"></p>
<p>对应设置</p>
<p><img src="/./imgs/image-20251211124809757.png" alt="image-20251211124809757"></p>
<p>ssh到第二台继续</p>
<h5 id="挂载NAS（两台Nginx-ECS操作一致）"><a href="#挂载NAS（两台Nginx-ECS操作一致）" class="headerlink" title="挂载NAS（两台Nginx ECS操作一致）"></a>挂载NAS（两台Nginx ECS操作一致）</h5><p>Nginx需要访问存储在NAS上的前端静态资源。</p>
<p>1、打开NAS控制台，找到刚才创建的实例点击挂载</p>
<p><img src="/./imgs/image-20251211125623691.png" alt="image-20251211125623691"></p>
<p>2、按照步骤，将&#x2F;data&#x2F;html挂载到Nas的&#x2F;html上，Nas目录权限修改为777</p>
<p><img src="/./imgs/image-20251211125711971.png" alt="image-20251211125711971"></p>
<p>选中两台nignx服务器</p>
<p><img src="/./imgs/image-20251211125804398.png" alt="image-20251211125804398"></p>
<p><img src="/./imgs/image-20251211125914742.png" alt="image-20251211125914742"></p>
<p>3、上传dist.zip到某一台nginx ECS的&#x2F;data&#x2F;html下并解压</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /data/html</span><br><span class="line">yum -y install unzip</span><br><span class="line">unzip dist.zip</span><br></pre></td></tr></table></figure>

<p><img src="/./imgs/image-20251211131207920.png" alt="image-20251211131207920"></p>
<h5 id="Nginx配置修改（指向NAS与Java服务）"><a href="#Nginx配置修改（指向NAS与Java服务）" class="headerlink" title="Nginx配置修改（指向NAS与Java服务）"></a>Nginx配置修改（指向NAS与Java服务）</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份默认配置文件，避免配置错误无法恢复</span></span><br><span class="line"><span class="built_in">cp</span> /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf.bak</span><br><span class="line"><span class="comment"># 编辑Nginx主配置文件</span></span><br><span class="line">vim /usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<p>核心配置内容（替换原server块）：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">upstream</span> backend &#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">172.16.0.22:8090</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">172.16.0.23:8090</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;  <span class="comment"># 监听80端口</span></span><br><span class="line">    <span class="attribute">server_name</span>  localhost;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;  <span class="comment"># 设置字符集为UTF-8，避免中文乱码</span></span><br><span class="line">    <span class="attribute">index</span>  index.html index.htm;  <span class="comment"># 默认首页</span></span><br><span class="line">    <span class="attribute">root</span>   /data/html/dist;  <span class="comment"># 静态资源目录指向NAS挂载的dist目录</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转发Java微服务请求（/ylApp开头的请求）</span></span><br><span class="line">    <span class="section">location</span> /ylApp &#123;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>   X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>   Host      <span class="variable">$http_host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line">        <span class="attribute">proxy_pass</span>         http://backend;</span><br><span class="line">        <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 错误页面配置（500/502/503/504错误时跳转）</span></span><br><span class="line">    <span class="attribute">error_page</span>   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /50x.html;</span><br><span class="line">    <span class="section">location</span> = /50x.html &#123;</span><br><span class="line">        <span class="attribute">root</span>   html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动Nginx并设置开机自启：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重新启动Nginx服务</span></span><br><span class="line">systemctl restart nginx.service</span><br><span class="line"><span class="comment"># 设置开机自启</span></span><br><span class="line">systemctl <span class="built_in">enable</span> nginx.service</span><br><span class="line"><span class="comment"># 验证Nginx状态：执行systemctl status nginx.service，若显示“active (running)”，说明启动正常</span></span><br><span class="line"><span class="comment"># 测试静态资源访问：在跳板机执行curl http://localhost，若能返回前端index.html的内容，说明静态资源配置正常</span></span><br></pre></td></tr></table></figure>

<h4 id="Java-ECS部署（2台操作一致）"><a href="#Java-ECS部署（2台操作一致）" class="headerlink" title="Java ECS部署（2台操作一致）"></a>Java ECS部署（2台操作一致）</h4><h5 id="配置Java环境"><a href="#配置Java环境" class="headerlink" title="配置Java环境"></a>配置Java环境</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装OpenJDK（与传统环境一致，若需指定版本可下载对应rpm包）</span></span><br><span class="line">yum install -y java</span><br><span class="line"><span class="comment"># 验证Java环境：执行java -version，若显示类似“openjdk version &quot;1.8.0_382&quot;”，说明安装成功</span></span><br></pre></td></tr></table></figure>

<p><img src="/./imgs/image-20251211222354516.png" alt="image-20251211222354516"></p>
<h5 id="挂载NAS"><a href="#挂载NAS" class="headerlink" title="挂载NAS"></a>挂载NAS</h5><p>1.打开NAS控制台，找到刚才创建的实例点击挂载</p>
<p><img src="/./imgs/image-20251211223112348.png" alt="image-20251211223112348"></p>
<p>2.按照步骤，将&#x2F;data&#x2F;java挂载到Nas的&#x2F;java下，权限设置为777</p>
<p><img src="/./imgs/image-20251211223153228.png" alt="image-20251211223153228"></p>
<p><img src="/./imgs/image-20251211223452998.png" alt="image-20251211223452998"></p>
<p>3.上传jar包到某一台java ECS的&#x2F;data&#x2F;java下</p>
<p><img src="/./imgs/image-20251212083406196.png" alt="image-20251212083406196"></p>
<h5 id="java-ECS配置iptables实现IP映射"><a href="#java-ECS配置iptables实现IP映射" class="headerlink" title="java ECS配置iptables实现IP映射"></a>java ECS配置iptables实现IP映射</h5><p>Java应用需要连接RDS（MySQL）和Tair（Redis）。由于这两个服务的内网IP可能变化（特别是RDS和Redis），我们使用iptables配置NAT规则，将固定的IP地址转发到实际的服务地址，这样应用无需修改配置即可应对IP变化。</p>
<p><strong>查询RDS和Tair的内网IP</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y bind-utils</span><br><span class="line">nslookup rm-bp1vr49py6dq388u8.mysql.rds.aliyuncs.com</span><br><span class="line">nslookup r-bp1k8yzg3zcmxhgx25.redis.rds.aliyuncs.com</span><br></pre></td></tr></table></figure>

<p>查看mysql和redis的ip</p>
<p><strong>mysql</strong></p>
<p><img src="/./imgs/image-20251211224815576.png" alt="image-20251211224815576"></p>
<p><strong>redis</strong></p>
<p><img src="/./imgs/image-20251211225044875.png" alt="image-20251211225044875"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql:172.16.0.168</span><br><span class="line">redis:172.16.2.86</span><br></pre></td></tr></table></figure>

<p><strong>⭐配置 iptables 转发规则</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转发MySQL（3306端口）：将172.16.0.100:3306转发到实际RDS的3306端口</span></span><br><span class="line">iptables -t nat -A OUTPUT -d 172.16.0.100 -p tcp --dport 3306 -j DNAT --to-destination 172.16.0.168:3306</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转发Redis（6379端口）：将172.16.0.12:6379转发到实际Redis的6379端口</span></span><br><span class="line">iptables -t nat -A OUTPUT -d 172.16.0.12 -p tcp --dport 6379 -j DNAT --to-destination 172.16.2.86:6379</span><br></pre></td></tr></table></figure>

<p>脚本实现</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">vim ip_mapping_setup.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查是否为root用户</span></span><br><span class="line">if [ $(id -u) -ne 0 ]; then</span><br><span class="line">    echo &quot;请使用root用户运行此脚本！&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">yum install bind-utils -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置参数 - MySQL</span></span><br><span class="line">MYSQL_DOMAIN=&quot;rm-bp1vr49py6dq388u8.mysql.rds.aliyuncs.com&quot;  # MySQL RDS域名</span><br><span class="line">MYSQL_LOCAL_IP=&quot;172.16.0.100&quot;                  # 硬编码的本地MySQL IP</span><br><span class="line">MYSQL_PORT=&quot;3306&quot;                              # MySQL端口号</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置参数 - Redis</span></span><br><span class="line">REDIS_DOMAIN=&quot;r-bp1k8yzg3zcmxhgx25.redis.rds.aliyuncs.com&quot;   # Redis/Tair域名</span><br><span class="line">REDIS_LOCAL_IP=&quot;172.16.0.12&quot;                   # 硬编码的本地Redis IP</span><br><span class="line">REDIS_PORT=&quot;6379&quot;                              # Redis端口号</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">函数：更新指定服务的IP映射</span></span><br><span class="line">update_mapping() &#123;</span><br><span class="line">    local service_name=$1</span><br><span class="line">    local domain=$2</span><br><span class="line">    local local_ip=$3</span><br><span class="line">    local port=$4</span><br><span class="line">    </span><br><span class="line">    echo &quot;处理$&#123;service_name&#125;映射...&quot;</span><br><span class="line">    </span><br><span class="line">    # 获取域名对应的最新IP</span><br><span class="line">    NEW_IP=$(nslookup $domain | grep &#x27;Address:&#x27; | tail -n 1 | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line">    </span><br><span class="line">    # 检查是否成功获取IP</span><br><span class="line">    if [ -z &quot;$NEW_IP&quot; ]; then</span><br><span class="line">        echo &quot;错误：无法解析域名 $domain 的IP地址&quot;</span><br><span class="line">        return 1</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    echo &quot;域名 $domain 解析到的最新IP: $NEW_IP&quot;</span><br><span class="line">    </span><br><span class="line">    # 清除旧的NAT规则</span><br><span class="line">    echo &quot;清除旧的$&#123;service_name&#125; NAT规则...&quot;</span><br><span class="line">    iptables -t nat -D OUTPUT -d $local_ip -p tcp --dport $port -j DNAT --to-destination $NEW_IP:$port 2&gt;/dev/null</span><br><span class="line">    </span><br><span class="line">    # 添加新的NAT规则</span><br><span class="line">    echo &quot;添加新的$&#123;service_name&#125; NAT规则...&quot;</span><br><span class="line">    iptables -t nat -A OUTPUT -d $local_ip -p tcp --dport $port -j DNAT --to-destination $NEW_IP:$port</span><br><span class="line">    </span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新MySQL映射</span></span><br><span class="line">update_mapping &quot;MySQL&quot; $MYSQL_DOMAIN $MYSQL_LOCAL_IP $MYSQL_PORT</span><br><span class="line">if [ $? -ne 0 ]; then</span><br><span class="line">    echo &quot;MySQL映射更新失败&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新Redis映射</span></span><br><span class="line">update_mapping &quot;Redis&quot; $REDIS_DOMAIN $REDIS_LOCAL_IP $REDIS_PORT</span><br><span class="line">if [ $? -ne 0 ]; then</span><br><span class="line">    echo &quot;Redis映射更新失败&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">保存规则（根据不同系统可能需要调整）</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">if</span> [ -x <span class="string">&quot;<span class="subst">$(command -v iptables-save)</span>&quot;</span> ]; <span class="keyword">then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   iptables-save &gt; /etc/sysconfig/iptables</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   <span class="built_in">echo</span> <span class="string">&quot;规则已保存&quot;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">fi</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可选：显示当前的NAT规则</span></span><br><span class="line">echo &quot;当前的NAT规则：&quot;</span><br><span class="line">iptables -t nat -L OUTPUT --line-numbers</span><br><span class="line"></span><br><span class="line">echo &quot;所有操作完成&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/./imgs/image-20251212091726849.png" alt="image-20251212091726849"></p>
<h5 id="部署Java微服务"><a href="#部署Java微服务" class="headerlink" title="部署Java微服务"></a>部署Java微服务</h5><p>启动微服务（设置内存参数）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将jar包复制到执行目录中，例如/opt（该jar包执行时会在当前目录生成logs目录），不要在共享存储目录下执行</span></span><br><span class="line"><span class="built_in">cp</span> yl_application-1.0-SNAPSHOT.jar /opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后台启动Java微服务，设置初始内存512MB、最大内存2GB</span></span><br><span class="line"><span class="built_in">nohup</span> java -Xms512m -Xmx2g -jar /opt/yl_application-1.0-SNAPSHOT.jar &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证服务启动：执行ps -ef | grep java，若能看到JAR包进程，说明启动正常；执行tail -f /opt/logs/yulin-2025-10-19.log（替换为实际日期），查看日志是否有报错</span></span><br></pre></td></tr></table></figure>

<p><img src="/./imgs/image-20251212091637502.png" alt="image-20251212091637502"></p>
<h3 id="SLB-ALB配置（统一访问入口）"><a href="#SLB-ALB配置（统一访问入口）" class="headerlink" title="SLB&#x2F;ALB配置（统一访问入口）"></a>SLB&#x2F;ALB配置（统一访问入口）</h3><h4 id="1-创建ALB实例"><a href="#1-创建ALB实例" class="headerlink" title="1. 创建ALB实例"></a>1. 创建ALB实例</h4><p>进入阿里云”负载均衡ALB”控制台，点击”创建应用型负载均衡”。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>地域：选择与Nginx ECS一致的地域（杭州）</li>
<li>网络类型：选择”公网型”（需绑定EIP，使得外部用户可以访问）</li>
<li>实例规格：选择”基础版”（支持基础的HTTP&#x2F;HTTPS路由）</li>
<li>协议版本：选择”IPv4”（目前不需要IPv6）</li>
<li>VPC和交换机：选择”设备管理平台-VPC”和对应的交换机</li>
<li>完成创建，系统会为ALB分配一个内网IP和公网IP</li>
</ul>
<p><img src="/./imgs/image-20251212093258501.png" alt="image-20251212093258501"></p>
<p><img src="/./imgs/image-20251212093421318.png" alt="image-20251212093421318"></p>
<p><img src="/./imgs/image-20251212093601154.png" alt="image-20251212093601154"></p>
<h4 id="2-创建后端服务器组"><a href="#2-创建后端服务器组" class="headerlink" title="2. 创建后端服务器组"></a>2. 创建后端服务器组</h4><p>后端服务器组关联了真正处理请求的2台Nginx ECS。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>进入ALB实例详情，点击”服务器组”</li>
<li>点击”创建服务器组”，输入组名”Nginx-Group”</li>
<li>协议：选择HTTP</li>
<li>端口：输入80</li>
<li>健康检查：<ul>
<li>协议：HTTP</li>
<li>路径：&#x2F; （检查根路径是否可访问）</li>
<li>健康检查间隔：5秒</li>
<li>健康检查失败次数：3次</li>
<li>这样配置的含义是：如果Nginx连续3次（15秒内）无法响应健康检查，ALB会将其标记为不健康，停止转发流量</li>
</ul>
</li>
<li>在”后端服务器”中，添加2台Nginx ECS的内网IP和端口：<ul>
<li>172.16.2.20:80</li>
<li>172.16.2.21:80</li>
</ul>
</li>
</ul>
<p><img src="/./imgs/image-20251212093703599.png" alt="image-20251212093703599"></p>
<p><img src="/./imgs/image-20251212093754362.png" alt="image-20251212093754362"></p>
<p><img src="/./imgs/1760277126406.png" alt="1760277126406"></p>
<p><img src="/./imgs/image-20251212093814036.png" alt="image-20251212093814036"></p>
<p><img src="/./imgs/image-20251212093844321.png" alt="image-20251212093844321"></p>
<p><img src="/./imgs/image-20251212093911108.png" alt="image-20251212093911108"></p>
<h4 id="3-配置HTTP监听"><a href="#3-配置HTTP监听" class="headerlink" title="3. 配置HTTP监听"></a>3. 配置HTTP监听</h4><p>监听器定义了ALB接收什么流量，以及如何处理这些流量。</p>
<p><strong>配置步骤</strong>：</p>
<ul>
<li>进入ALB实例详情，点击”监听”</li>
<li>点击”创建监听”，参数如下：<ul>
<li>监听协议：HTTP</li>
<li>监听端口：80</li>
<li>默认动作：转发到”Nginx-Group”服务器组</li>
</ul>
</li>
<li>点击”确认创建”</li>
</ul>
<p>配置完成后，ALB会：</p>
<ol>
<li>监听来自互联网的HTTP请求（访问ALB的公网IP:80）</li>
<li>根据健康检查结果，将请求转发到健康的Nginx ECS</li>
<li>如果某台Nginx故障，自动将流量转向另一台</li>
</ol>
<p><img src="/./imgs/image-20251212094442157.png" alt="image-20251212094442157"></p>
<p>、<img src="/./imgs/image-20251212094500733.png" alt="image-20251212094500733"></p>
<p><img src="/./imgs/image-20251212094519842.png" alt="image-20251212094519842"></p>
<p><img src="/./imgs/image-20251212094541886.png" alt="image-20251212094541886"></p>
<p><img src="/./imgs/image-20251212094603354.png" alt="image-20251212094603354"></p>
<h3 id="验证与测试"><a href="#验证与测试" class="headerlink" title="验证与测试"></a>验证与测试</h3><p>服务访问测试：</p>
<ul>
<li>本地浏览器输入“<a target="_blank" rel="noopener" href="http://eip地址”(slb的公网ip),若能打开“设备管理平台”登录页面,说明前端静态资源加载正常./">http://EIP地址”（SLB的公网IP），若能打开“设备管理平台”登录页面，说明前端静态资源加载正常。</a></li>
</ul>
<p><img src="/./imgs/1760841491355.png"></p>
<ul>
<li>点击“登录”，若能成功进入平台首页，查看设备列表、用户管理等功能，说明Java微服务与数据库交互正常。</li>
</ul>
<p><img src="/./imgs/1760841562854.png"></p>
<ul>
<li>高可用测试：登录其中一台Nginx ECS，执行<code>systemctl stop nginx.service</code>停止Nginx服务；刷新浏览器，若仍能正常访问平台，说明SLB已自动剔除故障节点，流量切换到另一台Nginx ECS；测试完成后，执行<code>systemctl start nginx.service</code>恢复Nginx服务。</li>
</ul>
<p><img src="/./imgs/1760841639321.png"></p>
<p><img src="/./imgs/1760841798615.png"></p>
<p><img src="/./imgs/image-20251212162018585.png"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="架构总览"><a href="#架构总览" class="headerlink" title="架构总览"></a>架构总览</h3><p>本次部署构建了一个高可用、可扩展的云原生应用平台：</p>
<p><strong>网络层</strong>：通过VPC隔离网络，用安全组防护流量，用EIP提供公网访问入口。这提供了清晰的网络边界和安全控制。</p>
<p><strong>计算层</strong>：使用ECS虚拟机部署应用，包括2台Nginx前端代理服务器和2台Java后端服务器。相比物理服务器，ECS提供了弹性伸缩的能力——当流量增加时，可以快速添加新的ECS实例；当流量下降时，可以删除实例以降低成本。</p>
<p><strong>负载均衡层</strong>：ALB负载均衡器为整个系统提供了唯一的访问入口。它不仅分散流量，还通过健康检查自动识别和隔离故障节点，实现了高可用。当一台Nginx故障时，用户无感知地切换到另一台，保证了服务连续性。</p>
<p><strong>存储层</strong>：NAS提供了共享存储，前端资源和Java应用包无需在每台服务器上重复存储，更新时只需更新一份文件。RDS提供了企业级的数据库服务，具有自动备份、主从高可用、性能优化等特性。Tair缓存加速了热点数据的访问，减轻了数据库压力。</p>
<p><strong>数据管理</strong>：DMS简化了数据库运维，提供了SQL编辑、导入导出等工具。RDS的自动备份和恢复机制确保了数据安全。</p>
<h3 id="核心优势"><a href="#核心优势" class="headerlink" title="核心优势"></a>核心优势</h3><ol>
<li><p><strong>高可用性</strong>：通过负载均衡、多实例部署、自动故障转移，系统可以承受单个或多个节点的故障，用户服务不中断。</p>
</li>
<li><p><strong>弹性扩展</strong>：当业务增长时，可以轻松添加新的ECS实例；当业务下降时，可以删除实例。整个过程无需采购硬件、无需等待交付，秒级完成。</p>
</li>
<li><p><strong>成本优化</strong>：按需付费，用多少付多少。无需投入大量成本购买永远用不满的硬件。</p>
</li>
<li><p><strong>运维简化</strong>：</p>
<ul>
<li>中间件（RDS、Tair）由阿里云托管，无需自己运维数据库、缓存</li>
<li>通过NAS实现文件共享，无需在多个服务器间同步文件</li>
<li>通过安全组、EIP等云服务原生的功能，简化网络配置</li>
</ul>
</li>
<li><p><strong>安全加固</strong>：</p>
<ul>
<li>VPC隔离提供网络安全边界</li>
<li>安全组细粒度控制流量</li>
<li>RDS的数据加密、SQL防注入审计</li>
<li>内网ECS无公网IP，隐藏了服务器IP</li>
<li>跳板机作为唯一的管理入口，集中管理和审计</li>
</ul>
</li>
</ol>
<h3 id="后续可优化方向"><a href="#后续可优化方向" class="headerlink" title="后续可优化方向"></a>后续可优化方向</h3><ol>
<li><p><strong>监控与告警</strong>：集成阿里云的云监控和日志服务（SLS），实时监控各个组件的健康状态，异常时自动告警。</p>
</li>
<li><p><strong>自动扩缩容</strong>：根据CPU利用率、网络流量等指标，自动增减ECS实例数量，实现真正的”弹性”。</p>
</li>
<li><p><strong>容器化与Kubernetes</strong>：使用Docker容器化应用，通过ACK（阿里云Kubernetes服务）进行容器编排，进一步降低运维复杂度。</p>
</li>
<li><p><strong>CI&#x2F;CD流水线</strong>：集成代码提交、自动编译、自动部署流程，实现快速迭代。</p>
</li>
<li><p><strong>灾难恢复</strong>：配置RDS跨地域备份，定期进行灾难恢复演练，确保在极端情况下能快速恢复业务。</p>
</li>
<li><p><strong>成本优化</strong>：通过购买阿里云的”包年包月”资源获得更优惠的价格；使用”竞价实例”（抢占式实例）降低计算成本。</p>
</li>
</ol>
<h3 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h3><p>从传统IT到云计算的迁移是一个逐步的过程。本次部署虽然还未采用最先进的微服务、容器化技术，但已经充分展现了云计算的核心优势：通过虚拟化、自动化、服务化，将复杂的基础设施管理工作大幅简化，让开发和运维团队能够专注于业务逻辑的实现。</p>
<p>希望这份文档能帮助你更好地理解云计算架构，以及如何将应用从传统数据中心迁移到云上。在实际的运维工作中，持续监控系统性能，及时优化配置，才是构建一个真正稳定、高效的云平台的关键。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Felix</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/12/12/%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/">http://example.com/2025/12/12/%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/imgs/adater.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/15/Kubernetes%20%E9%85%8D%E7%BD%AE%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/" title="Kubernetes 配置资源管理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Kubernetes 配置资源管理</div></div><div class="info-2"><div class="info-item-1">Kubernetes 配置资源管理一、为什么需要 Secret 和 ConfigMap？在开发容器化应用时，我们经常面临一个问题：如何安全地管理应用配置和敏感信息？ 传统做法是把这些信息直接写入代码或镜像中，这样做有严重隐患：  敏感信息（密码、API密钥）被暴露在代码仓库中 不同环境的配置硬编码，难以维护 修改配置需要重新构建镜像，效率低下  Kubernetes 提供了 Secret 和 ConfigMap 两个资源对象来解决这些问题。  二、Secret：敏感信息的保险箱核心作用Secret 专门用于存储和管理敏感数据，让这些信息与应用代码和镜像分离。 工作中的常见用途1. 数据库连接凭证 123456789# 存储数据库用户名和密码apiVersion: v1kind: Secretmetadata:  name: db-secrettype: Opaquedata:  username: cm9vdA==        # base64编码的 &quot;root&quot;  password: aGFzaDAzMjE=    # base64编码的密码  2. 镜像...</div></div></div></a><a class="pagination-related" href="/2025/12/10/Kubernetes-Pod%E7%9A%84%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%9B%B4%E6%96%B0/" title="Kubernetes Pod的升级与更新"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Kubernetes Pod的升级与更新</div></div><div class="info-2"><div class="info-item-1">Kubernetes Pod的升级与更新一、滚动升级&#x2F;更新（Rolling Update）原理与流程滚动升级是逐步替换Pod的过程，在更新期间保持部分Pod运行，确保服务持续可用。 执行流程123456789初始状态: [Pod1:v1] [Pod2:v1] [Pod3:v1]        ↓第1步:   [Pod1:v2] [Pod2:v1] [Pod3:v1]  (停止1个旧Pod，启动1个新Pod)        ↓第2步:   [Pod1:v2] [Pod2:v2] [Pod3:v1]  (继续逐步替换)        ↓第3步:   [Pod1:v2] [Pod2:v2] [Pod3:v2]  (最后替换)        ↓完成状态: [Pod1:v2] [Pod2:v2] [Pod3:v2]  (全部更新完毕)  核心参数配置123456spec:  strategy:    type: RollingUpdate    rollingUpdate:      maxSurge: 25%          # 允许超出副本数的最大Pod数（支持百分比或具体...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/imgs/adater.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Felix</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/falsezxy"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">阿里云-设备管理平台部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E5%B9%B3%E5%8F%B0%E6%8A%80%E6%9C%AF%E6%98%A0%E5%B0%84%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.2.</span> <span class="toc-text">云平台技术映射与架构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%B1%82"><span class="toc-number">1.2.1.</span> <span class="toc-text">一、网络基础设施层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-VPC%EF%BC%88Virtual-Private-Cloud-%E8%99%9A%E6%8B%9F%E7%A7%81%E6%9C%89%E4%BA%91%EF%BC%89"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">1. VPC（Virtual Private Cloud - 虚拟私有云）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Subnet-Vswitch%EF%BC%89"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2. 交换机（Subnet&#x2F;Vswitch）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%89%E5%85%A8%E7%BB%84%EF%BC%88Security-Group%EF%BC%89"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">3. 安全组（Security Group）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-EIP%EF%BC%88%E5%BC%B9%E6%80%A7%E5%85%AC%E7%BD%91IP%EF%BC%89"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">4. EIP（弹性公网IP）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AE%A1%E7%AE%97%E4%B8%8E%E9%83%A8%E7%BD%B2%E5%B1%82"><span class="toc-number">1.2.2.</span> <span class="toc-text">二、计算与部署层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ECS%EF%BC%88Elastic-Compute-Service-%E5%BC%B9%E6%80%A7%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%89"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">1. ECS（Elastic Compute Service - 弹性云服务器）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%95%9C%E5%83%8F%EF%BC%88Image%EF%BC%89"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2. 镜像（Image）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BD%91%E7%BB%9C%E4%B8%8E%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%B1%82"><span class="toc-number">1.2.3.</span> <span class="toc-text">三、网络与负载均衡层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-SLB-ALB%EF%BC%88%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%89"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">1. SLB&#x2F;ALB（负载均衡）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ACR%EF%BC%88%E9%98%BF%E9%87%8C%E4%BA%91%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%EF%BC%89"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2. ACR（阿里云容器镜像仓库）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AD%98%E5%82%A8%E5%B1%82"><span class="toc-number">1.2.4.</span> <span class="toc-text">四、存储层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-NAS%EF%BC%88Network-Attached-Storage-%E7%BD%91%E7%BB%9C%E5%AD%98%E5%82%A8%EF%BC%89"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">1. NAS（Network Attached Storage - 网络存储）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-RDS%EF%BC%88%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">2. RDS（关系型数据库服务）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Tair%EF%BC%88%E5%85%BC%E5%AE%B9Redis%EF%BC%89"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">3. Tair（兼容Redis）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E4%B8%8E%E7%AE%A1%E7%90%86%E5%B1%82"><span class="toc-number">1.2.5.</span> <span class="toc-text">五、数据迁移与管理层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-DTS%EF%BC%88%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">1. DTS（数据传输服务）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-DMS%EF%BC%88%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">2. DMS（数据管理服务）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%97%A5%E5%BF%97%E4%B8%8E%E7%9B%91%E6%8E%A7%E5%B1%82"><span class="toc-number">1.2.6.</span> <span class="toc-text">六、日志与监控层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-SLS%EF%BC%88%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">1. SLS（日志服务）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E8%A6%81%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="toc-number">1.2.7.</span> <span class="toc-text">简要对应关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E8%BF%87%E7%A8%8B"><span class="toc-number">1.3.</span> <span class="toc-text">部署过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%EF%BC%88VPC-%E5%AE%89%E5%85%A8%E7%BB%84%EF%BC%89"><span class="toc-number">1.3.1.</span> <span class="toc-text">前置网络配置（VPC+安全组）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#VPC%E4%B8%8E%E4%BA%A4%E6%8D%A2%E6%9C%BA%E8%B4%AD%E4%B9%B0%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">VPC与交换机购买与配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%BB%84%E5%88%9B%E5%BB%BA"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">安全组创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EIP%E8%B4%AD%E4%B9%B0%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.2.</span> <span class="toc-text">EIP购买和配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%EF%BC%88%E5%85%88%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%90%8EECS%EF%BC%89"><span class="toc-number">1.3.3.</span> <span class="toc-text">中间件部署配置（先中间件后ECS）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RDS%EF%BC%88MySQL%EF%BC%89%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">RDS（MySQL）配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.3.1.1.</span> <span class="toc-text">创建实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%AB%98%E6%9D%83%E9%99%90%E8%B4%A6%E5%8F%B7"><span class="toc-number">1.3.3.1.2.</span> <span class="toc-text">创建高权限账号</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.3.1.3.</span> <span class="toc-text">创建数据库</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DMS%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">DMS数据管理服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B0%E5%A2%9Emysql%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.3.2.1.</span> <span class="toc-text">新增mysql实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.3.2.2.</span> <span class="toc-text">导入数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">1.3.3.2.3.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tair%EF%BC%88%E5%85%BC%E5%AE%B9Redis%EF%BC%89%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">Tair（兼容Redis）配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">1.3.3.3.1.</span> <span class="toc-text">创建实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%8D%E5%AF%86%E8%AE%BF%E9%97%AE"><span class="toc-number">1.3.3.3.2.</span> <span class="toc-text">免密访问</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%99%BD%E5%90%8D%E5%8D%95"><span class="toc-number">1.3.3.3.3.</span> <span class="toc-text">设置白名单</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NAS%E9%85%8D%E7%BD%AE%EF%BC%88%E5%AD%98%E5%82%A8dist-jar%E5%8C%85%EF%BC%89"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">NAS配置（存储dist&#x2F;jar包）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECS%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%EF%BC%88%E6%8C%89%E8%A7%92%E8%89%B2%E9%83%A8%E7%BD%B2%EF%BC%89"><span class="toc-number">1.3.4.</span> <span class="toc-text">ECS部署配置（按角色部署）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E4%B9%B0esc"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">购买esc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%B7%B3%E6%9D%BF%E6%9C%BA%EF%BC%88%E5%A4%8D%E7%94%A8%E7%9A%84nginx-1-ecs%EF%BC%89"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">配置跳板机（复用的nginx-1 ecs）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nginx-ecs%E9%83%A8%E7%BD%B2%EF%BC%88%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%EF%BC%89"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">Nginx ecs部署（编译安装）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E4%B8%8E%E7%BC%96%E8%AF%91Nginx%EF%BC%88%E4%B8%A4%E5%8F%B0Nginx-ECS%E6%93%8D%E4%BD%9C%E4%B8%80%E8%87%B4%EF%BC%89"><span class="toc-number">1.3.4.3.1.</span> <span class="toc-text">安装依赖与编译Nginx（两台Nginx ECS操作一致）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%82%E8%BD%BDNAS%EF%BC%88%E4%B8%A4%E5%8F%B0Nginx-ECS%E6%93%8D%E4%BD%9C%E4%B8%80%E8%87%B4%EF%BC%89"><span class="toc-number">1.3.4.3.2.</span> <span class="toc-text">挂载NAS（两台Nginx ECS操作一致）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Nginx%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9%EF%BC%88%E6%8C%87%E5%90%91NAS%E4%B8%8EJava%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.3.4.3.3.</span> <span class="toc-text">Nginx配置修改（指向NAS与Java服务）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Java-ECS%E9%83%A8%E7%BD%B2%EF%BC%882%E5%8F%B0%E6%93%8D%E4%BD%9C%E4%B8%80%E8%87%B4%EF%BC%89"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">Java ECS部署（2台操作一致）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEJava%E7%8E%AF%E5%A2%83"><span class="toc-number">1.3.4.4.1.</span> <span class="toc-text">配置Java环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%82%E8%BD%BDNAS"><span class="toc-number">1.3.4.4.2.</span> <span class="toc-text">挂载NAS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#java-ECS%E9%85%8D%E7%BD%AEiptables%E5%AE%9E%E7%8E%B0IP%E6%98%A0%E5%B0%84"><span class="toc-number">1.3.4.4.3.</span> <span class="toc-text">java ECS配置iptables实现IP映射</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Java%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.4.4.4.</span> <span class="toc-text">部署Java微服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SLB-ALB%E9%85%8D%E7%BD%AE%EF%BC%88%E7%BB%9F%E4%B8%80%E8%AE%BF%E9%97%AE%E5%85%A5%E5%8F%A3%EF%BC%89"><span class="toc-number">1.3.5.</span> <span class="toc-text">SLB&#x2F;ALB配置（统一访问入口）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BAALB%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">1. 创建ALB实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%84"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">2. 创建后端服务器组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AEHTTP%E7%9B%91%E5%90%AC"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">3. 配置HTTP监听</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E4%B8%8E%E6%B5%8B%E8%AF%95"><span class="toc-number">1.3.6.</span> <span class="toc-text">验证与测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E6%80%BB%E8%A7%88"><span class="toc-number">1.4.1.</span> <span class="toc-text">架构总览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8A%BF"><span class="toc-number">1.4.2.</span> <span class="toc-text">核心优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD%E5%8F%AF%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">1.4.3.</span> <span class="toc-text">后续可优化方向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E7%9A%84%E8%AF%9D"><span class="toc-number">1.4.4.</span> <span class="toc-text">最后的话</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/18/CI%20CD%20%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90Ruo-Yi%E9%A1%B9%E7%9B%AE/" title="CI/CD持续集成Ruo-Yi项目">CI/CD持续集成Ruo-Yi项目</a><time datetime="2025-12-18T11:27:44.000Z" title="Created 2025-12-18 19:27:44">2025-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/18/jenkins%E9%83%A8%E7%BD%B2ruoyi%E9%A1%B9%E7%9B%AE/" title="jenkins部署ruoyi项目">jenkins部署ruoyi项目</a><time datetime="2025-12-18T01:44:25.000Z" title="Created 2025-12-18 09:44:25">2025-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/17/Kubernets-network_rbac_hpa/" title="Kubernetes 网络、RBAC 和 HPA 相关知识">Kubernetes 网络、RBAC 和 HPA 相关知识</a><time datetime="2025-12-17T10:34:40.000Z" title="Created 2025-12-17 18:34:40">2025-12-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/16/Kubernetes-Ingress%E6%9C%8D%E5%8A%A1/" title="Kubernetes-Ingress服务">Kubernetes-Ingress服务</a><time datetime="2025-12-16T10:12:58.000Z" title="Created 2025-12-16 18:12:58">2025-12-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/16/Kubernetes%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/" title="Kubernetes存储管理">Kubernetes存储管理</a><time datetime="2025-12-16T01:35:04.000Z" title="Created 2025-12-16 09:35:04">2025-12-16</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/imgs/background_footer.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Felix</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>